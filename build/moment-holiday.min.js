//! moment-holiday.js
//! version : 1.5.1
//! author : Kodie Grantham
//! license : MIT
//! https://github.com/kodie/moment-holiday
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("moment")):"function"==typeof define&&define.amd?define(["moment"],t):t((e=e||self).moment)}(this,function(moment){moment=moment&&moment.hasOwnProperty("default")?moment.default:moment;var parserExtensions=[],parseHoliday=function(e,t,n){for(var r,o=[],a=0;a<parserExtensions.length;a++){var i=parserExtensions[a](e,t);!i&&!1!==i||(r=i)}if(!1===r)return!1;if("string"==typeof r?t=r:r&&(o=r),!moment.isMoment(o)&&!o.length&&t.charAt(0).match(/[0-9(]/)){var s=!1,l=t.split("|");1<l.length&&(s=!0),2<l.length&&(l=[l[0],l[1]]);for(a=0;a<l.length;a++){var h=moment(e),f=l[a].split("/");if(1===f.length||2===f.length&&"("!==f[1].charAt(0)&&4===f[1].length){var y=l[a];a=-1,l=[];for(var d=1;d<13;d++)l.push(d+"/"+y)}else if(2<f.length&&h.year(parseInt(f[2])),h.month(parseInt(f[0])-1),"("===f[1].charAt(0)){var m=f[1].slice(1,-1).split(","),c=parseInt(m[0]),u=parseInt(m[1]),g=moment(h).startOf("month"),v=moment(h).endOf("month").diff(g,"days")+1,p=[];if(m[1]&&"["===m[1].charAt(0)){var w=!0;(u=parseInt(m[1].slice(1,-1)))<0&&(w=!1,u=parseInt(m[1].slice(2,-1))),g=moment(h).date(u);for(var k=0;k<7;k++){if(g.day()===c){o.push(moment(g));break}w?g.add(1,"day"):g.subtract(1,"day")}continue}for(var O=0;O<v;O++)g.day()===c&&p.push(moment(g)),g.add(1,"day");if(!u){o=o.concat(p);continue}h=u<0?p[p.length+u]:p[u-1],o.push(h)}else o.push(h.date(f[1]))}if(s&&1<o.length){var H=o[1].diff(o[0],"days");if(1<H){var b=moment(o[0]);o=[o[0]];for(a=0;a<H;a++)b.add(1,"day"),o.push(moment(b))}}}o=arrayify(o);for(a=0;a<o.length;a++)moment.isMoment(o[a])?(n&&(0===o[a].day()&&(o[a]=o[a].add(1,"day")),6===o[a].day()&&(o[a]=o[a].subtract(1,"day"))),o[a]=o[a].startOf("day")):delete o[a];return!!o.length&&(1===o.length?o[0]:o)},keywordMatches=function(e,t){var n=[];t=arrayify(t);for(var r=0;r<t.length;r++){var o=e.match(new RegExp(t[r],"gi"));o&&(n=n.concat(o))}return n},findHoliday=function(e,t,n,r,o){var a={},i=[],s={};if(h=o||moment.holidays.active,h.hasOwnProperty(t))i.push(t);else if(fk=findKey(t,h))i.push(fk);else{for(var l in h)if(h.hasOwnProperty(l)){if(a[l]=keywordMatches(t,l.split(/[\s,.-]+/).filter(function(e){return 2<e.length})).length,h[l].keywords_n)if(keywordMatches(t,h[l].keywords_n).length){a[l]=0;continue}if(h[l].keywords_y){var f=keywordMatches(t,h[l].keywords_y);if(!f||f.length!==h[l].keywords_y.length){a[l]=0;continue}a[l]+=f.length}if(h[l].keywords){var y=keywordMatches(t,h[l].keywords);if(!y)continue;a[l]+=y.length}}for(var d in a)a[d]&&a.hasOwnProperty(d)&&(i.length&&a[d]!==a[i[0]]?a[d]>a[i[0]]&&(i=[d]):i.push(d))}if(!i.length)return!1;if(!1===r)return i;for(var m=0;m<i.length;m++){var c=parseHoliday(e,h[i[m]].date,n);c&&(s[i[m]]=c)}return!!Object.keys(s).length&&s},findHolidays=function(e,t,n,r,o){var a=[];r&&(a={}),t=arrayify(t),o=o||moment.holidays.active;for(var i=0;i<t.length;i++){var s=findHoliday(e,t[i],n,r,o);s&&(a=r?merge(a,s):a.concat(s))}return a},getAllHolidays=function(e,t){var n=moment.holidays.active,r={};for(var o in n)n.hasOwnProperty(o)&&(td=parseHoliday(e,n[o].date,t))&&(r[o]=td);return r},compileRegions=function(e,t){var n=moment.holidays[e],r={};if(n)for(var o=0;o<t.length;o++){var a=t[o].toLowerCase(),i=moment.holidays[e+"/"+a];for(var s in i={},n)if(n.hasOwnProperty(s)){var l=n[s].regions||[],h=n[s].regions_n||[];l.length&&l.join().toLowerCase().split(),h.length&&h.join().toLowerCase().split(),(!l.length&&!h.length||l.length&&~l.indexOf(a)||h.length&&!~h.indexOf(a))&&(i[s]=n[s])}i&&(r=merge(r,i))}return!!Object.keys(r).length&&r},getLocale=function(locale){return regions=locale.split("/"),locale=regions[0].toLowerCase().replace(" ","_"),regions.shift(),moment.holidays[locale]||"undefined"==typeof require||("undefined"!=typeof process&&"test"==process.env.NODE_ENV?eval("require")("./locale/"+locale):require("../locale/"+locale)),!!moment.holidays[locale]&&(regions.length?compileRegions(locale,regions):moment.holidays[locale])},holidayLoop=function(e,t,n,r){t=t||1;for(var o=getAllHolidays(e,r),a=moment(e),i=e.year(),s=[],l=0;l<t;l++)for(var h=moment(a);;){var f=!1;if(n?h.add(1,"day"):h.subtract(1,"day"),h.year()!==i&&(o=getAllHolidays(h,r),i=h.year()),!Object.keys(o).length){f=!0;break}for(var y in o)if(o.hasOwnProperty(y)){for(var d=!1,m=arrayify(o[y]),c=0;c<m.length;c++)if(h.isSame(m[c],"day")){s.push(m[c]),a=moment(h),d=!0;break}if(d){f=!0;break}}if(f)break}return!!s.length&&(1===s.length?s[0]:s)},arrayify=function(e){return e&&e.constructor!==Array?[e]:e},findKey=function(e,t){t.constructor===Object&&(t=Object.keys(t));for(var n=0;n<t.length;n++)if(e.toLowerCase()===t[n].toLowerCase())return t[n];return!1},merge=function(e,t){return Object.assign({},e,t)};return moment.fn.holiday=function(e,t){moment.holidays.active;var n={},r=!1;if(e){e.constructor!==Array&&(r=!0,e=[e]);for(var o=0;o<e.length;o++)(td=findHoliday(this,e[o],t))&&(n=Object.assign({},n,td))}else n=getAllHolidays(this,t);var a=Object.keys(n);return!!a.length&&(1===a.length&&r?n[a[0]]:n)},moment.fn.holidays=function(e,t){return this.holiday(e,t)},moment.fn.isHoliday=function(e,t){var n,r,o=[];if(r=e?(e=arrayify(e),n=this.holiday(e,t),!1):(n=getAllHolidays(this,t),!0),!n)return!1;for(var a in n)if(n.hasOwnProperty(a))for(var i=arrayify(n[a]),s=0;s<i.length;s++)if(this.isSame(i[s],"day")){if(!r)return!0;o.push(a)}return!!o.length&&(1===o.length?o[0]:o)},moment.fn.previousHoliday=function(e,t){return holidayLoop(this,e,!1,t)},moment.fn.previousHolidays=function(e,t){return this.previousHoliday(e,t)},moment.fn.nextHoliday=function(e,t){return holidayLoop(this,e,!0,t)},moment.fn.nextHolidays=function(e,t){return this.nextHoliday(e,t)},moment.fn.holidaysBetween=function(e,t){e=e||new Date,e=moment(e).subtract(1,"day");for(var n=getAllHolidays(this,t),r=moment(this),o=r.year(),a=[],i=0;i<e.diff(this,"days")&&(r.add(1,"day"),r.year()!==o&&(n=getAllHolidays(r,t),o=r.year()),Object.keys(n).length);i++)for(var s in n){for(var l=!1,h=arrayify(n[s]),f=0;f<h.length;f++)if(r.isSame(h[f],"day")){a.push(h[f]),l=!0;break}if(l)break}return!!a.length&&a},moment.holidays={active:{},active_last:{}},moment.modifyHolidays={set:function(e,t){var n={};if(e.constructor===Array){for(var r=[],o=0;o<e.length;o++){var a=findHoliday(this,e[o],null,!1);a&&(r=r.concat(a))}if(r.length)for(var i in n=merge(moment.holidays.active))n.hasOwnProperty(i)&&(~r.indexOf(i)||delete n[i])}else if("string"==typeof e){var s=getLocale(e);if(s)if(t){var l=findHolidays(this,t,!1,!1,s);for(o=0;o<l.length;o++)n[l[o]]=merge(s[l[o]])}else n=merge(s)}else n=e;return!Object.keys(n).length&&e!==n||Object.is(moment.holidays.active,n)||(moment.holidays.active_last=merge(moment.holidays.active),moment.holidays.active=n),this},add:function(e,t){if("string"==typeof e){var n=getLocale(e);if(e={},n)if(t)for(var r=findHolidays(this,t,!1,!1,n),o=0;o<r.length;o++)e[r[o]]=merge(n[r[o]]);else e=n}return Object.keys(e).length&&(moment.holidays.active_last=merge(moment.holidays.active),moment.holidays.active=merge(moment.holidays.active,e)),this},remove:function(e){e=arrayify(e);var t=findHolidays(this,e,!1,!1),n=merge(moment.holidays.active);if(t)for(var r=0;r<t.length;r++)delete n[t[r]];return Object.is(moment.holidays.active,n)||(moment.holidays.active_last=merge(moment.holidays.active),moment.holidays.active=n),this},undo:function(){var e=merge(moment.holidays.active);return moment.holidays.active=merge(moment.holidays.active_last),moment.holidays.active_last=e,this},load:function(e){e=arrayify(e);for(var t=0;t<e.length;t++)getLocale(e[t]);return this},extendParser:function(e){return parserExtensions.push(e),this}},moment});
//# sourceMappingURL=moment-holiday.min.js.map
